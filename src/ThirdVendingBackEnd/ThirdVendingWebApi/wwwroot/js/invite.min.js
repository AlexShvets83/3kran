function sendInvite(){var r=document.getElementById("inviteError"),n;r.style.display="none";const t=$("#inviteForm").dxForm("instance"),i=t.validate();if(i&&i.isValid){const u=t.option("formData");n=$("#loadpanel").dxLoadPanel({shadingColor:"rgba(0,0,0,0.4)",position:{of:"#employee"},visible:!1,showIndicator:!0,showPane:!0,shading:!0,closeOnOutsideClick:!1}).dxLoadPanel("instance");n.show();$.postJSON("/api/account/invite",u,null).then(function(){n.hide();$("#invitePopup").modal("hide")},function(t){if(t.readyState===4&&t.status===200)n.hide(),$("#invitePopup").modal("hide");else{n.hide();const i=t.responseText?t.responseText:`Error${t.status}`;document.getElementById("inviteError").innerHTML=i;document.getElementById("inviteError").style.display="block"}})}}function openInvitePopup(){var n;const t=$("#inviteForm").dxForm({readOnly:!1,showColonAfterLabel:!0,labelLocation:"left",items:[{dataField:"email",label:{text:"Email",visible:!0},validationRules:[{type:"required",message:"Введите email."},{type:"email",message:"Неверный email."},{type:"async",message:"Email уже зарегистрирован.",validationCallback:function(n){return checkEmail(n.value)}}]},{dataField:"role",editorType:"dxSelectBox",label:{text:"Роль"},editorOptions:{dataSource:roles,valueExpr:"name",displayExpr:"view",onValueChanged:function(i){var u=i.value,r=t.getEditor("ownerId");switch(u){case"technician":r.option("disabled",!1);t.itemOption("ownerId","label",{text:"Владелец"});$.getJSON("/api/users/getAllOwners",null).then(function(t){n.option("dataSource",t)},function(n){(n.status===401||n.status===403)&&logout()});break;case"owner":case"dealer_admin":r.option("disabled",!1);t.itemOption("ownerId","label",{text:"Дилер"});$.getJSON("/api/users/getAllDealers",null).then(function(t){n.option("dataSource",t)},function(n){(n.status===401||n.status===403)&&logout()});break;case"dealer":r.option("disabled",!0);break;case"admin":r.option("disabled",!0)}}}},{dataField:"ownerId",editorType:"dxSelectBox",label:{text:"Дилер"},editorOptions:{displayExpr:"name",valueExpr:"id",onInitialized:function(t){n=t.component}}}]}).dxForm("instance")}